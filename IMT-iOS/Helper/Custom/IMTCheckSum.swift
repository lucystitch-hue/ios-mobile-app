//
//  IMTCheckSum.swift
//  IMT-iOS
//
//  Created by dev on 03/10/2023.
//

import Foundation

class CheckSum {
    private static let table: [Int: Int] = {
        var map = [Int: Int]()
        map[0] = 54319
        map[1] = 4129
        map[2] = 8258
        map[3] = 12387
        map[4] = 16516
        map[5] = 20645
        map[6] = 24774
        map[7] = 28903
        map[8] = 33032
        map[9] = 37161
        map[10] = 41290
        map[11] = 45419
        map[12] = 49548
        map[13] = 53677
        map[14] = 57806
        map[15] = 61935
        map[16] = 4657
        map[17] = 528
        map[18] = 12915
        map[19] = 8786
        map[20] = 21173
        map[21] = 17044
        map[22] = 29431
        map[23] = 25302
        map[24] = 37689
        map[25] = 33560
        map[26] = 45947
        map[27] = 41818
        map[28] = 54205
        map[29] = 50076
        map[30] = 62463
        map[31] = 58334
        map[32] = 9314
        map[33] = 13379
        map[34] = 1056
        map[35] = 5121
        map[36] = 25830
        map[37] = 29895
        map[38] = 17572
        map[39] = 21637
        map[40] = 42346
        map[41] = 46411
        map[42] = 34088
        map[43] = 38153
        map[44] = 58862
        map[45] = 62927
        map[46] = 50604
        map[47] = 54669
        map[48] = 13907
        map[49] = 9842
        map[50] = 5649
        map[51] = 1584
        map[52] = 30423
        map[53] = 26358
        map[54] = 22165
        map[55] = 18100
        map[56] = 46939
        map[57] = 42874
        map[58] = 38681
        map[59] = 34616
        map[60] = 63455
        map[61] = 59390
        map[62] = 55197
        map[63] = 51132
        map[64] = 18628
        map[65] = 22757
        map[66] = 26758
        map[67] = 30887
        map[68] = 2112
        map[69] = 6241
        map[70] = 10242
        map[71] = 14371
        map[72] = 51660
        map[73] = 55789
        map[74] = 59790
        map[75] = 63919
        map[76] = 35144
        map[77] = 39273
        map[78] = 43274
        map[79] = 47403
        map[80] = 23285
        map[81] = 19156
        map[82] = 31415
        map[83] = 27286
        map[84] = 6769
        map[85] = 2640
        map[86] = 14899
        map[87] = 10770
        map[88] = 56317
        map[89] = 52188
        map[90] = 64447
        map[91] = 60318
        map[92] = 39801
        map[93] = 35672
        map[94] = 47931
        map[95] = 43802
        map[96] = 27814
        map[97] = 31879
        map[98] = 19684
        map[99] = 23749
        map[100] = 11298
        map[101] = 15363
        map[102] = 3168
        map[103] = 7233
        map[104] = 60846
        map[105] = 64911
        map[106] = 52716
        map[107] = 56781
        map[108] = 44330
        map[109] = 48395
        map[110] = 36200
        map[111] = 40265
        map[112] = 32407
        map[113] = 28342
        map[114] = 24277
        map[115] = 20212
        map[116] = 15891
        map[117] = 11826
        map[118] = 7761
        map[119] = 3696
        map[120] = 65439
        map[121] = 61374
        map[122] = 57309
        map[123] = 53244
        map[124] = 48923
        map[125] = 44858
        map[126] = 40793
        map[127] = 36728
        map[128] = 37256
        map[129] = 33193
        map[130] = 45514
        map[131] = 41451
        map[132] = 53516
        map[133] = 49453
        map[134] = 61774
        map[135] = 57711
        map[136] = 4224
        map[137] = 161
        map[138] = 12482
        map[139] = 8419
        map[140] = 20484
        map[141] = 16421
        map[142] = 28742
        map[143] = 24679
        map[144] = 33721
        map[145] = 37784
        map[146] = 41979
        map[147] = 46042
        map[148] = 49981
        map[149] = 54044
        map[150] = 58239
        map[151] = 62302
        map[152] = 689
        map[153] = 4752
        map[154] = 8947
        map[155] = 13010
        map[156] = 16949
        map[157] = 21012
        map[158] = 25207
        map[159] = 29270
        map[160] = 46570
        map[161] = 42443
        map[162] = 38312
        map[163] = 34185
        map[164] = 62830
        map[165] = 58703
        map[166] = 54572
        map[167] = 50445
        map[168] = 13538
        map[169] = 9411
        map[170] = 5280
        map[171] = 1153
        map[172] = 29798
        map[173] = 25671
        map[174] = 21540
        map[175] = 17413
        map[176] = 42971
        map[177] = 47098
        map[178] = 34713
        map[179] = 38840
        map[180] = 59231
        map[181] = 63358
        map[182] = 50973
        map[183] = 55100
        map[184] = 9939
        map[185] = 14066
        map[186] = 1681
        map[187] = 5808
        map[188] = 26199
        map[189] = 30326
        map[190] = 17941
        map[191] = 22068
        map[192] = 55628
        map[193] = 51565
        map[194] = 63758
        map[195] = 59695
        map[196] = 39368
        map[197] = 35305
        map[198] = 47498
        map[199] = 43435
        map[200] = 22596
        map[201] = 18533
        map[202] = 30726
        map[203] = 26663
        map[204] = 6336
        map[205] = 2273
        map[206] = 14466
        map[207] = 10403
        map[208] = 52093
        map[209] = 56156
        map[210] = 60223
        map[211] = 64286
        map[212] = 35833
        map[213] = 39896
        map[214] = 43963
        map[215] = 48026
        map[216] = 19061
        map[217] = 23124
        map[218] = 27191
        map[219] = 31254
        map[220] = 2801
        map[221] = 6864
        map[222] = 10931
        map[223] = 14994
        map[224] = 64814
        map[225] = 60687
        map[226] = 56684
        map[227] = 52557
        map[228] = 48554
        map[229] = 44427
        map[230] = 40424
        map[231] = 36297
        map[232] = 31782
        map[233] = 27655
        map[234] = 23652
        map[235] = 19525
        map[236] = 15522
        map[237] = 11395
        map[238] = 7392
        map[239] = 3265
        map[240] = 61215
        map[241] = 65342
        map[242] = 53085
        map[243] = 57212
        map[244] = 44955
        map[245] = 49082
        map[246] = 36825
        map[247] = 40952
        map[248] = 28183
        map[249] = 32310
        map[250] = 20053
        map[251] = 24180
        map[252] = 11923
        map[253] = 16050
        map[254] = 3793
        map[255] = 7920
        return map
    }()
        
    static public func calculate(_ source: String) -> String {
        let text = Array(source)
        var count = 0
        var value = 0
        
        for letter in text {
            if table.count <= count {
                count -= table.count
            }
            
            let asciiValue = Int(letter.unicodeScalars.first!.value)
            
            value += table[count]! * asciiValue
            count += 1
        }
        
        let hex = String(value, radix: 16)
        return hex.suffix(2).uppercased()
    }
}

